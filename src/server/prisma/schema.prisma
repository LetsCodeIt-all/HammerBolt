// This is your Prisma schema file,

// learn more about it in the docs: https://pris.ly/d/prisma-schema



// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?

// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init



generator client {

Â  provider = "prisma-client-js"

}



datasource db {

Â  provider = "postgresql"

Â  urlÂ  Â  Â  = env("DATABASE_URL")

}

model User {

Â  nameÂ  Â  Â  Â  Â StringÂ  Â @uniqueÂ  Â 

Â  idÂ  Â  Â  Â  Â  Â StringÂ  Â @id @default(uuid())

Â  emailÂ  Â  Â  Â  StringÂ  Â @unique

Â  passwordHash String

Â  createdAtÂ  Â  DateTime @default(now())

Â  updatedAtÂ  Â  DateTime @updatedAt

}

model Cart {
  id        String     @id @default(uuid())
  userId    String     @unique 
  // ğŸŸ¢ Relationship: A Cart has many CartItems
  items     CartItem[] 
}

model Product {
  id        String     @id @default(uuid())
  name      String
  price     Float
  imageUrl String
  // ğŸ”´ REMOVE: The global 'quantity' field here (it should be in CartItem)
  
  // ğŸŸ¢ Relationship: A Product can be in many CartItems
  items     CartItem[]
}

// â­ï¸ The new Junction Model (CartItem) â­ï¸
model CartItem {
  id        String    @id @default(uuid())
  quantity  Int       @default(1) // ğŸ‘ˆ Stores the number of this product in the cart

  // Many-to-One: Link to Cart
  cartId    String
  cart      Cart      @relation(fields: [cartId], references: [id])

  // Many-to-One: Link to Product
  productId String
  product   Product   @relation(fields: [productId], references: [id])
  
  // Ensures a user only has one entry for a specific product in their cart
  @@unique([cartId, productId]) 
}